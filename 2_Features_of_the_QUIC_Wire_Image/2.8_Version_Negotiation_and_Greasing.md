---
title: "2.8. 版本协商与位转义"
anchor: "2.8_Version_Negotiation_and_Greasing"
weight: 280
rank: "h2"
---

Version Negotiation packets are used by the server to indicate that a requested version from the client is not supported (see Section 6 of [QUIC-TRANSPORT]). Version Negotiation packets are not intrinsically protected, but future QUIC versions could use later encrypted messages to verify that they were authentic. Therefore, any modification of this list will be detected and may cause the endpoints to terminate the connection attempt.

服务器使用版本协商数据包来表明客户端所请求的版本不受支持（详见《[QUIC传输](../RFC9000_Chinese_Simplified)》的[第6章](../RFC9000_Chinese_Simplified/#6_Version_Negotiation)）。本质上版本协商数据包并不受保护，但是将来的QUIC版本可以使用后续的加密消息来验证其内容的真实性。于是，对数据包中的支持版本字段的任何篡改都能够被检测出来，且使得终端终止连接企图。

Also note that the list of versions in the Version Negotiation packet may contain reserved versions. This mechanism is used to avoid ossification in the implementation of the selection mechanism. Further, a client may send an Initial packet with a reserved version number to trigger version negotiation. In the Version Negotiation packet, the connection IDs of the client's Initial packet are reflected to provide a proof of return-routability. Therefore, changing this information will also cause the connection to fail.

还要注意的是，版本协商数据包中列出的版本中可能出现被保留使用的版本。这项机制是为了避免版本选择机制的实现趋于僵化。此外，客户端可以发送一个带有被保留使用的版本号的初始数据包，来触发版本协商。在版本协商数据包中，对客户端初始数据包中的连接ID的回显能够证明回程路径的路由可达性。

QUIC is expected to evolve rapidly. Therefore, new versions (both experimental and IETF standard versions) will be deployed on the Internet more often than with other commonly deployed Internet and transport-layer protocols. Use of the Version field for traffic recognition will therefore behave differently than with these protocols. Using a particular version number to recognize valid QUIC traffic is likely to persistently miss a fraction of QUIC flows and completely fail in the near future. Reliance on the Version field for the purpose of admission control is also likely to lead to unintended failure modes. Admission of QUIC traffic regardless of version avoids these failure modes, avoids unnecessary deployment delays, and supports continuous version-based evolution.

QUIC的版本有望快速迭代。因此，新的版本（既包括实验性的版本，也包含符合IETF标准的版本）将在互联网上比其他常见的互联网和传输层协议得到更频繁的部署。因此将版本字段用于流量识别的做法在QUIC上会与在那些协议上的行为大不相同。使用某特定的版本号来识别合法QUIC流量的做法很有可能永久地错失一部分QUIC流量，且在不久的将来完全失效。依赖版本字段来进行出入控制也很有可能导致意外的故障。无关版本地对QUIC流量放行能够避免此类故障、避免不必要的部署延迟，并支持连续的基于版本的传输协议迭代。
